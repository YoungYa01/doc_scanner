[uwsgi]
chdir = /home/ubuntu/project/doc_scanner
module = doc_scanner.wsgi
pythonpath = /home/ubuntu/project/doc_scanner

# 进程管理
master = true
processes = 1

# Socket 配置
socket = /home/ubuntu/project/doc_scanner/uwsgi.sock
chmod-socket = 664
vacuum = true

# PID 文件
pidfile = /home/ubuntu/project/doc_scanner/uwsgi-master.pid

# 运行用户
uid = www-data
gid = www-data

# 进程隔离（关键配置）
die-on-term = true
no-orphans = true
procname-prefix = doc_scanner

# 资源限制
reload-on-rss = 9000
evil-reload-on-rss = 9000
reload-mercy = 5
harakiri = 600
harakiri-verbose = true
max-requests = 3000

# 请求处理
post-buffering = 25600000
post-buffering-bufsize = 262144

# 日志配置
daemonize = /home/ubuntu/project/doc_scanner/doc_scanner.log
log-maxsize = 5120000
disable-logging = false

# 错误处理
ignore-sigpipe = true
ignore-write-errors = true
disable-write-exception = true